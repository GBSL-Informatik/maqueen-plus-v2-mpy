"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[238],{7786:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>l,frontMatter:()=>r,metadata:()=>a,toc:()=>h});var d=i(5893),s=i(1151);const r={sidebar_position:6},t="Kompass",a={id:"api/compass",title:"Kompass",description:"Der Micro\\Bit relativ zum Erdmagnetfeld bestimmt werden. Norden ist dabei dort, wo die h\xf6chste Magnetkraft gemessen wird.",source:"@site/docs/api/compass.md",sourceDirName:"api",slug:"/api/compass",permalink:"/maqueen-plus-v2-mpy/docs/api/compass",draft:!1,unlisted:!1,editUrl:"https://github.com/GBSL-Informatik/maqueen-plus-v2-mpy/tree/main/website/docs/api/compass.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Ultraschallsensor",permalink:"/maqueen-plus-v2-mpy/docs/api/ultrasonic"},next:{title:"Hindernisumgehung",permalink:"/maqueen-plus-v2-mpy/docs/examples/obstacle-avoidance"}},c={},h=[{value:"<code>mq_heading()</code>",id:"mq_heading",level:3},{value:"<code>heading_diff(heading0)</code>",id:"heading_diffheading0",level:3},{value:"Parameter",id:"parameter",level:4},{value:"Beispiel",id:"beispiel",level:4},{value:"<code>heading_set_window_size(size)</code>",id:"heading_set_window_sizesize",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h3:"h3",h4:"h4",img:"img",p:"p",pre:"pre",...(0,s.a)(),...e.components},{Dl:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Dl",!0),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.h1,{id:"kompass",children:"Kompass"}),"\n",(0,d.jsx)(n.p,{children:"Der Micro:Bit enth\xe4lt einen Magnetsensor (Magnetometer), welcher die Magnetfeldst\xe4rke (\xb5T) in drei Dimensionen misst. Mit Hilfe des Magnetometers kann die Ausrichtung des Micro:Bit relativ zum Erdmagnetfeld bestimmt werden. Norden ist dabei dort, wo die h\xf6chste Magnetkraft gemessen wird."}),"\n",(0,d.jsxs)(n.p,{children:["Da f\xfcr einen Kompass die Ausrichtung nur in der Ebene bestimmt werden soll, wird mit dem Beschleunigungssensor (Accelerometer) die Neigung des Micro:Bit relativ zur Erdoberfl\xe4che bestimmt. Zusammen mit den Magnetometer Werten kann so die Ausrichtung mit der Funktion ",(0,d.jsx)(n.code,{children:"heading"})," abgefragt werden:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"from microbit import *\nwhile True:\n    print('Ausrichtung: ', compass.heading())\n    sleep(1000)\n"})}),"\n",(0,d.jsx)(n.p,{children:"Der Micro:Bit macht dabei die Annahme, dass die y-Achse nach vorne zeigt und die z-Achse nach oben."}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:i(3899).Z+"",width:"653",height:"768"})}),"\n",(0,d.jsx)(n.p,{children:"Da der Micro:Bit aber im Maqueen so montiert ist, dass die y-Achse nach oben zeigt und die z-Achse nach vorne, ist die Annahme falsch und die Ausrichtung wird nicht mehr korrekt berechnet."}),"\n",(0,d.jsx)(n.h3,{id:"mq_heading",children:(0,d.jsx)(n.code,{children:"mq_heading()"})}),"\n",(0,d.jsx)(n.p,{children:"Gibt die Ausrichtung des Maqueen in Grad zwischen 0 und 359 zur\xfcck. Die Ausrichtung wird mit den Daten des Accelerometers und des Magnetometers berechnet."}),"\n",(0,d.jsx)(n.admonition,{title:"Elektromagnetische St\xf6rungen durch die Motoren",type:"danger",children:(0,d.jsx)(n.p,{children:"Beachte, dass die Motoren des Maqueen elektromagnetische St\xf6rungen verursachen. Achte deshalb darauf, dass die Ausrichtung nur abgefragt wird, wenn die Drehgeschwindigkeiten der Motoren nicht ver\xe4ndert werden. Noch bessere Ergebnise werden erzielt, wenn die Motoren nicht laufen."})}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"mq_heading() # => 0-359\n"})}),"\n",(0,d.jsx)(n.h3,{id:"heading_diffheading0",children:(0,d.jsx)(n.code,{children:"heading_diff(heading0)"})}),"\n",(0,d.jsxs)(n.p,{children:["Gibt die Differenz zwischen der aktuellen Ausrichtung und der angegebenen Ausrichtung ( ",(0,d.jsx)(n.code,{children:"heading0"}),") in Grad zwischen -180 und 180 zur\xfcck. Um die Resultate weniger st\xf6rungsanf\xe4llig zu machen, wird ein ",(0,d.jsx)(n.em,{children:"moving average filter"})," angewandt (Standardfenstergr\xf6sse ist 1). Die Fenstergr\xf6sse kann mit der Funktion ",(0,d.jsx)(n.a,{href:"#heading_set_window_sizesize",children:(0,d.jsx)(n.code,{children:"heading_set_window_size"})})," ge\xe4ndert werden."]}),"\n",(0,d.jsx)(n.h4,{id:"parameter",children:"Parameter"}),"\n",(0,d.jsxs)(r,{children:[(0,d.jsx)("dt",{children:(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"heading0"})})}),(0,d.jsx)("dd",{children:(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"float"})})}),(0,d.jsx)("dd",{children:(0,d.jsx)(n.p,{children:"Die Referenz-Ausrichtung in Grad zwischen 0 und 359."})}),(0,d.jsx)("dt",{children:(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"apply_window"})})}),(0,d.jsx)("dd",{children:(0,d.jsx)(n.p,{children:(0,d.jsx)(n.em,{children:"optional"})})}),(0,d.jsx)("dd",{children:(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"True"})," (default)"]})}),(0,d.jsx)("dd",{children:(0,d.jsx)(n.p,{children:(0,d.jsx)(n.code,{children:"False"})})})]}),"\n",(0,d.jsx)(n.h4,{id:"beispiel",children:"Beispiel"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"initial_heading = 20\n# maqueen um 45 \xb0 nach rechts gedreht, d.h. die Ausrichtung ist jetzt 65 \xb0\nheading_diff(initial_heading) # => 45\n# maqueen nun um 90 \xb0 nach links gedreht, d.h. die Ausrichtung ist nun bei -25 \xb0\nheading_diff(initial_heading) # => -45\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Um die aktuelle Messung ohne Filterung zu erhalten, kann ",(0,d.jsx)(n.code,{children:"apply_window"})," auf ",(0,d.jsx)(n.code,{children:"False"})," gesetzt werden."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"heading_diff(initial_heading, apply_window=False) # => -45\n"})}),"\n",(0,d.jsx)(n.h3,{id:"heading_set_window_sizesize",children:(0,d.jsx)(n.code,{children:"heading_set_window_size(size)"})}),"\n",(0,d.jsx)(n.p,{children:"Setzt die Gr\xf6sse des Filterfensters, welches bei der Berechnung der Ausrichtungsdifferenz benutzt wird."}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"heading_set_window_size(5) # => window size of 5\n"})}),"\n",(0,d.jsxs)(n.p,{children:["Um den Filter zu deaktivieren, kann die Fenstergr\xf6sse auf ",(0,d.jsx)(n.code,{children:"1"})," gesetzt werden."]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-py",children:"heading_set_window_size(1) # => no moving average filter\n"})})]})}function l(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},3899:(e,n,i)=>{i.d(n,{Z:()=>d});const d=i.p+"assets/images/microbit-axis-flat-72bbe464b1ac3a298603c55dce97bb7e.webp"},1151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>t});var d=i(7294);const s={},r=d.createContext(s);function t(e){const n=d.useContext(r);return d.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),d.createElement(r.Provider,{value:n},e.children)}}}]);