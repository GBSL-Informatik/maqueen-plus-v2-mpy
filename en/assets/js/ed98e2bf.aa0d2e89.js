"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[238],{7786:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>c});var a=i(5893),s=i(1151);const t={sidebar_position:6},d="Kompass",o={id:"api/compass",title:"Kompass",description:"Compass Heading",source:"@site/docs/api/compass.md",sourceDirName:"api",slug:"/api/compass",permalink:"/maqueen-plus-v2-mpy/en/docs/api/compass",draft:!1,unlisted:!1,editUrl:"https://github.com/GBSL-Informatik/maqueen-plus-v2-mpy/tree/main/packages/create-docusaurus/templates/shared/docs/api/compass.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Ultraschallsensor",permalink:"/maqueen-plus-v2-mpy/en/docs/api/ultrasonic"}},r={},c=[{value:"Compass Heading",id:"compass-heading",level:3},{value:"<code>mq_heading()</code>",id:"mq_heading",level:4},{value:"<code>heading_diff(heading0: float, apply_window: bool = True)</code>",id:"heading_diffheading0-float-apply_window-bool--true",level:4},{value:"<code>heading_set_window_size(size: int)</code>",id:"heading_set_window_sizesize-int",level:4}];function l(e){const n={code:"code",h1:"h1",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"kompass",children:"Kompass"}),"\n",(0,a.jsx)(n.h3,{id:"compass-heading",children:"Compass Heading"}),"\n",(0,a.jsxs)(n.p,{children:["Since the compass is mounted in the maqueen such that the y-axis points upwards and the z-axis points forward, the heading calculated by the micro",":bit"," is not correct (it assumes the y-axis points forward and the z-axis points upwards)."]}),"\n",(0,a.jsxs)(n.p,{children:["Therefore, a tilt-compensated compass heading is calculated using the accelerometer and magnetometer data assuming the micro",":bit"," is mounted in the maqueen."]}),"\n",(0,a.jsx)(n.h4,{id:"mq_heading",children:(0,a.jsx)(n.code,{children:"mq_heading()"})}),"\n",(0,a.jsx)(n.p,{children:"The heading is returned in degrees between 0 and 359. The heading is calculated using the accelerometer and magnetometer data."}),"\n",(0,a.jsx)(n.p,{children:"! Pay attention to inferring the heading while the maqueen is moving, since the motors produce magnetic noise."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-py",children:"mq_heading() # => 0-359\n"})}),"\n",(0,a.jsx)(n.h4,{id:"heading_diffheading0-float-apply_window-bool--true",children:(0,a.jsx)(n.code,{children:"heading_diff(heading0: float, apply_window: bool = True)"})}),"\n",(0,a.jsx)(n.p,{children:"Returns the difference between the current heading and the specified heading in degrees between -180 and 180."}),"\n",(0,a.jsxs)(n.p,{children:["To get more stable results, a moving average filter is applied to the heading (default window size is 1). The window size can be changed by setting the global variable ",(0,a.jsx)(n.code,{children:"heading_set_window_size"})," (see below)."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-py",children:"initial_heading = 20\n# maqueen turned by 45 degrees to the right\nheading_diff(initial_heading) # => 45\n# maqueen now turned by 90 degrees to the left\nheading_diff(initial_heading) # => -45\n"})}),"\n",(0,a.jsxs)(n.p,{children:["the moving average filter can be disabled by setting ",(0,a.jsx)(n.code,{children:"apply_window"})," to ",(0,a.jsx)(n.code,{children:"False"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-py",children:"heading_diff(initial_heading, apply_window=False) # => -45\n"})}),"\n",(0,a.jsx)(n.h4,{id:"heading_set_window_sizesize-int",children:(0,a.jsx)(n.code,{children:"heading_set_window_size(size: int)"})}),"\n",(0,a.jsx)(n.p,{children:"Sets the window size of the moving average filter used to calculate the heading difference."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-py",children:"heading_set_window_size(5) # => window size of 5\n"})}),"\n",(0,a.jsxs)(n.p,{children:["To disable the moving average filter, set the window size to ",(0,a.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-py",children:"heading_set_window_size(1) # => no moving average filter\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>o,a:()=>d});var a=i(7294);const s={},t=a.createContext(s);function d(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);